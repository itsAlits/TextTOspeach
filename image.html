<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Image to Text</title>
  </head>
  <body class="container mx-auto flex items-center py-10 h-screen">
    <main
      class="h-full w-full border border-gray-300 shadow flex overflow-hidden"
    >
      <!-- sidbar -->
      <div class="sidebar w-20 h-full">
        <div class="sidebarMenu pt-5 px-3">
          <!-- tooltip -->
          <a href="index.html">
            <div
              class="tooltip tooltip-right bg-transparent shadow-none border-none rounded-xl btn flex items-center"
              data-tip="Text To Speach"
            >
              <!-- tooltip menu -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="size-6"
              >
                <path
                  d="M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 0 0 1.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06ZM18.584 5.106a.75.75 0 0 1 1.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 0 1-1.06-1.06 8.25 8.25 0 0 0 0-11.668.75.75 0 0 1 0-1.06Z"
                />
                <path
                  d="M15.932 7.757a.75.75 0 0 1 1.061 0 6 6 0 0 1 0 8.486.75.75 0 0 1-1.06-1.061 4.5 4.5 0 0 0 0-6.364.75.75 0 0 1 0-1.06Z"
                />
              </svg>
            </div>
          </a>

          <!-- tooltip -->
          <a href="chatgpt.html">
            <div
              class="tooltip tooltip-right btn shadow-none border-none rounded-xl bg-transparent flex items-center mt-2"
              data-tip="ChatGPT"
            >
              <!-- tooltip menu -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="size-6"
              >
                <path
                  fill-rule="evenodd"
                  d="M4.804 21.644A6.707 6.707 0 0 0 6 21.75a6.721 6.721 0 0 0 3.583-1.029c.774.182 1.584.279 2.417.279 5.322 0 9.75-3.97 9.75-9 0-5.03-4.428-9-9.75-9s-9.75 3.97-9.75 9c0 2.409 1.025 4.587 2.674 6.192.232.226.277.428.254.543a3.73 3.73 0 0 1-.814 1.686.75.75 0 0 0 .44 1.223ZM8.25 10.875a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25ZM10.875 12a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875-1.125a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25Z"
                  clip-rule="evenodd"
                />
              </svg>
            </div>
          </a>
          <!-- tooltip -->
          <div
            class="tooltip tooltip-right btn btn-neutral rounded-xl flex items-center mt-2"
            data-tip="Image To Text"
          >
            <!-- tooltip menu -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
              class="size-6"
            >
              <path
                fill-rule="evenodd"
                d="M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z"
                clip-rule="evenodd"
              />
            </svg>
          </div>
        </div>
      </div>
      <!-- end sidebar -->

      <div class="mainCanvas w-full py-10">
        <div class="title ps-10 pb-4">
          <h1 class="text-xl font-bold">Image-To-Text</h1>
        </div>
        <div class="border-bottom mt-5"></div>
        <div class="imgInput ps-10 mt-8">
          <p class="text-[14px] mb-2">
            Masukan File Gambar Dapat Berupa jpg/jpeg/png
          </p>
          <input
            id="imageInput"
            type="file"
            accept="image/jpeg,image/png"
            class="file-input file-input-bordered w-full max-w-2xl"
          />
          <button class="btn btn-neutral ms-1" onclick="sendImg()">
            <span id="buttonText">Process</span>
            <svg
              id="loadingIcon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
              class="size-6 hidden"
            >
              <path
                fill-rule="evenodd"
                d="M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z"
                clip-rule="evenodd"
              />
            </svg>
          </button>
        </div>

        <hr class="mt-10" />

        <!-- Section to display the extracted text -->
        <div id="resultSection" class="px-10 mt-8">
          <div class="flex justify-between items-center mb-5">
            <div>
              <h2 class="text-lg font-semibold">
                Hasil Ekstrak Teks Dari Gambar:
              </h2>
              <p class="text-[14px]">
                Notes : Akurasi Dari Ekstrasi Bisa saja Kurang Akurat Cuy Jadi
                Di Enjoykan Aja ya
              </p>
            </div>
            <!-- Copy to Clipboard button -->
            <button
              id="copyButton"
              class="btn btn-neutral"
              onclick="copyToClipboard()"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="size-5"
              >
                <path
                  fill-rule="evenodd"
                  d="M10.5 3A1.501 1.501 0 0 0 9 4.5h6A1.5 1.5 0 0 0 13.5 3h-3Zm-2.693.178A3 3 0 0 1 10.5 1.5h3a3 3 0 0 1 2.694 1.678c.497.042.992.092 1.486.15 1.497.173 2.57 1.46 2.57 2.929V19.5a3 3 0 0 1-3 3H6.75a3 3 0 0 1-3-3V6.257c0-1.47 1.073-2.756 2.57-2.93.493-.057.989-.107 1.487-.15Z"
                  clip-rule="evenodd"
                />
              </svg>

              Copy to Clipboard
            </button>
          </div>

          <div id="extractedText" class="border p-4 w-full min-h-[150px]"></div>
        </div>
      </div>
    </main>

    <script>
      async function sendImg() {
        const imageInput = document.getElementById("imageInput").files[0];

        if (!imageInput) {
          alert("Please select an image file.");
          return;
        }

        document.getElementById("buttonText").textContent = "Processing...";
        document.getElementById("loadingIcon").classList.remove("hidden");

        const reader = new FileReader();
        reader.readAsDataURL(imageInput);
        reader.onload = async function () {
          const base64String = reader.result.split(",")[1];

          const data = new FormData();
          data.append("base64", base64String);

          const options = {
            method: "POST",
            headers: {
              "x-rapidapi-key":
                "5b56e76766msh7d6c5d00f3a1dcap14031fjsn4bdd19800a0a",
              "x-rapidapi-host": "ocr-extract-text.p.rapidapi.com",
            },
            body: data,
          };

          try {
            const response = await fetch(
              "https://ocr-extract-text.p.rapidapi.com/ocr",
              options
            );
            const result = await response.json();

            const extractedTextElement =
              document.getElementById("extractedText");
            extractedTextElement.textContent = result.text
              ? result.text
              : "No text extracted.";

            if (result.text) {
              document.getElementById("copyButton").classList.remove("hidden");
            } else {
              document.getElementById("copyButton").classList.add("hidden");
            }
          } catch (error) {
            console.error(error);
            alert("Failed to process image.");
            document.getElementById("extractedText").textContent =
              "Error extracting text.";
          } finally {
            document.getElementById("buttonText").textContent = "Process";
            document.getElementById("loadingIcon").classList.add("hidden");
          }
        };

        reader.onerror = function (error) {
          console.error("Error: ", error);
          alert("Failed to read image file.");
        };
      }

      function copyToClipboard() {
        const textToCopy = document.getElementById("extractedText").textContent;

        navigator.clipboard.writeText(textToCopy).then(
          function () {
            alert("Text copied to clipboard!");
          },
          function (err) {
            console.error("Error copying text: ", err);
            alert("Failed to copy text.");
          }
        );
      }
    </script>
  </body>
</html>
